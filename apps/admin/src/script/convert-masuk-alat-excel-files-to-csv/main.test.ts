import { describe, expect, it } from "vitest";

// These are the expected sheet names from the Excel file that should have data
// This list is generated from running the conversion script
const EXPECTED_SHEET_NAMES = [
  "MF 190",
  "MF 170",
  "MF 150",
  "LF 120",
  "LF 90",
  "LF 50",
  "CB 220",
  "CB 205",
  "CB 193",
  "CB 185",
  "JOINPIN",
  "JB 60",
  "UH 60",
  "JB 40",
  "UH 40",
  "JB 55 PCH",
  "UH 55 PCH",
  "JB 60 PCH",
  "UH 60 PCH",
  "JB 70 PCH",
  "UH 70 PCH",
  "JB 85",
  "UH 85",
  "CATWALK",
  "TANGGA 170",
  "TANGGA 190",
  "FIXED CLAMP",
  "SWIVEL CLAMP",
  "BEAM CLAMP",
  "SLEEVE COUPLER",
  "PIPE SUPPORT",
  "PIPA 1",
  "PIPA 1.2",
  "PIPA 1.5",
  "PIPA 2",
  "PIPA 3",
  "PIPA 4",
  "PIPA 6",
  "RODA",
  "HORRY BEAM",
  "BASE PLATE",
  "JOINER",
  "CANTILEVER 0.9",
  "ASIBA 1",
  "ASIBA 1.6",
  "ASIBA 2",
  "ASIBA 3",
  "ASIBA 4",
  "LEDGER 0.6 RL",
  "LEDGER 0.9 RL",
  "LEDGER 1.2 RL",
  "LEDGER 1.5 RL",
  "LEDGER 1.8 RL",
  "V BEAM BRACKET",
  "VERTICAL 1 RL",
  "VERTICAL 2 RL",
  "LEDGER 0.6 PCH",
  "LEDGER 0.9 PCH",
  "LEDGER 1.2 PCH",
  "LEDGER 1.5 PCH",
  "LEDGER 1.8 PCH",
  "VERTICAL 0.5 PCH",
  "VERTICAL 1 PCH",
  "VERTICAL 1.5 PCH",
  "VERTICAL 2 PCH",
  "TANGGA PCH",
  "H 4X6X1",
  "H 4X6X1.5",
  "H 4X6X2",
  "H 4X6X2.5",
  "H 4X6X3",
  "H 4X6X4",
  "H 5X5X1",
  "H 5X5X1.2",
  "H 5X5X1.5",
  "H 5X5X2",
  "H 5X5X2.4",
  "H 5X5X2.5",
  "H 5X5X3",
  "H 5X5X4",
  "H 5X5X6",
  "H 5X10X1.5",
  "H 5X10X2",
  "H 5X10X2.5",
  "H 5X10X3",
  "H 5X10X3.5",
  "H 5X10X4",
  "SURI 4X6X1",
  "SURI 4X6X1.5",
  "SURI 4X6X2",
  "SURI 5X10X1.5",
  "SURI 5X10X2",
  "SIKU 30X30",
  "SIKU 30X35",
  "SIKU 35X35",
  "SIKU 40X40",
  "SIKU 45X40",
  "SIKU 40X50",
  "SIKU 45X45",
  "SIKU 45X50",
  "SIKU 50X50",
  "SIKU 60X60",
  "SIKU 70X70",
  "KAWEL",
  "TIEBAR 40",
  "TIEBAR 50",
  "TIEBAR 60",
  "TIEBAR 70",
  "TIEBAR 80",
  "TIEROD 0.4",
  "TIEROD 0.5",
  "TIEROD 0.6",
  "TIEROD 0.7",
  "TIEROD 0.8",
  "TIEROD 0.95",
  "TIEROD 1",
  "TIEROD 1.2",
  "TIEROD 1.5",
  "TIEROD 3",
  "TIEROD 6",
  "WINGNUT",
  "PUSH PULL 1",
  "PUSH PULL 2",
  "PUSH PULL 3",
  "SW 1170",
  "SW 1730",
  "SW 2340",
  "SW 3560",
  "SW 4780",
  "COUPLING 1M",
  "CNP 125X3.5M",
  "CNP 125 X 4 M",
  "CC 640X640",
  "CC 640X780",
  "WEDGE K",
  "WEDGE KZ",
  "WEDGE HEAD PIECE",
];

describe("convert-masuk-alat-excel-files-to-csv", () => {
  it("should have all expected workbook sheet names", () => {
    // Verify expected sheet count
    expect(EXPECTED_SHEET_NAMES.length).toBe(137);
  });

  it("should have unique sheet names", () => {
    const uniqueNames = new Set(EXPECTED_SHEET_NAMES);
    expect(uniqueNames.size).toBe(EXPECTED_SHEET_NAMES.length);
  });

  it("should have valid sheet names (no invalid filename characters)", () => {
    const invalidChars = /[<>:"/\\|?*]/;
    for (const name of EXPECTED_SHEET_NAMES) {
      expect(name).not.toMatch(invalidChars);
    }
  });
});
